class ComboClassConfigurator{constructor(a){Array.isArray(a)?this.initialConfigs=a:(()=>{throw new Error("Invalid classConfigs parameter. An array is expected.")})(),this.classConfigs=[],this.scrollObservers=new Map,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>this.setup()):this.setup()}setup(){const a=["ease","ease-in","ease-out","ease-in-out"],b={eventName:"click",transitionTime:"0s",removeTransitionTime:null,easingMode:"ease",entryThreshold:0,exitThreshold:null,parentElement:"",triggerElement:"",once:!1,debounce:0,switchAction:!1,repeatConfiguration:1,triggerAttribut:"",parentAttribute:"",callback:null,classesAdded:!1,start:1,end:0,frequency:1,addClasses:[],removeClasses:[],topAddClasses:[]};this.initialConfigs.forEach(c=>{const d={...b,...c};d.easingMode=a.includes(d.easingMode)?d.easingMode:b.easingMode,d.entryThreshold=this._validateThreshold(d.entryThreshold,b.entryThreshold),d.exitThreshold=this._validateThreshold(d.exitThreshold,b.exitThreshold),d.addClasses=this._cleanClasses(d.addClasses),d.removeClasses=this._cleanClasses(d.removeClasses),d.topAddClasses=this._cleanClasses(d.topAddClasses);const e="number"==typeof d.repeatConfiguration&&1<=d.repeatConfiguration?Math.floor(d.repeatConfiguration):1;0<d.topAddClasses.length&&(0<d.removeClasses.length?(console.warn(`'removeClasses' should not be defined when 'topAddClasses' is set. It will be ignored.`),d.removeClasses=[]):null,d.switchAction?(console.warn(`'switchAction' should not be defined when 'topAddClasses' is set. It will be set to false.`),d.switchAction=!1):null),d.triggerAttribut&&d.parentAttribute?this._processAttributeBasedPairing(d):this._processRepeatConfiguration(d,e)}),this.initEventListeners()}_validateThreshold(a,b){return"number"==typeof a&&0<=a&&100>=a?a:b}_cleanClasses(a){return Array.isArray(a)?a.map(a=>a.replace(".","").trim()).filter(Boolean):[]}_processAttributeBasedPairing(a){const b=document.querySelectorAll(`[${a.parentAttribute}]`),c=document.querySelectorAll(`[${a.triggerAttribut}]`),d=this._mapElementsByAttribute(b,a.parentAttribute),e=this._mapElementsByAttribute(c,a.triggerAttribut);d.forEach((b,c)=>{if(e.has(c)){const d=e.get(c);b.forEach(b=>{d.forEach(c=>{this.classConfigs.push({...a,parentElement:b,triggerElement:c,repeatConfiguration:1,triggerAttribut:"",parentAttribute:""})})})}})}_mapElementsByAttribute(a,b){const c=new Map;return a.forEach(a=>{const d=a.getAttribute(b).trim();d&&(c.has(d)?c.get(d).push(a):c.set(d,[a]))}),c}_processRepeatConfiguration(a,b){for(let c=1;c<=b;c++){const b=1==c?"":`-${c}`,d=a=>a?a.endsWith(b)?a:`${a}${b}`:"",e=d(a.parentElement),f=d(a.triggerElement);this.classConfigs.push({...a,parentElement:e,triggerElement:f,repeatConfiguration:1})}}initEventListeners(){const a=a=>a?a.startsWith(".")?document.querySelector(a):document.getElementById(a):null,b=(a,b=0)=>{let c=null,d=null,e=null;const f=()=>{c=null,a(...e),e=null};return function(...g){e=g,null===c&&(c=requestAnimationFrame(f)),0<b&&(clearTimeout(d),d=setTimeout(()=>{null!==c&&(cancelAnimationFrame(c),c=null),a(...e),e=null},b))}},c=new Map([["click",this._handleClick.bind(this)],["hover",this._handleHover.bind(this)],["scrollInView",this._handleScrollInView.bind(this)]]);this.classConfigs.forEach(d=>{const{eventName:e,entryThreshold:f,exitThreshold:g,debounce:h,once:i,switchAction:j,topAddClasses:k}=d;let l=null;if(d.triggerElement&&(l=d.triggerElement instanceof Element?d.triggerElement:a(d.triggerElement)),d.triggerElement&&!l)return;const m=b(()=>{d.once&&d.classesAdded||(this._initClasses(d,"add"),d.classesAdded=!0,d.callback&&d.callback(l||null,"add"))},h),n=b(()=>{i||(this._initClasses(d,"remove"),d.classesAdded=!1,d.callback&&d.callback(l||null,"remove"))},h),o=c.get(e);o?o(l,d,m,n,this._calculateThresholds(f,g)):this._applyImmediateClasses(d)})}_calculateThresholds(a,b){const c=new Set;return c.add(a/100),null!==b&&c.add(b/100),Array.from(c)}_initClasses(a,b){const{targetClass:c,addClasses:d,removeClasses:e,topAddClasses:f,frequency:g,start:h,end:i,transitionTime:j,removeTransitionTime:k,easingMode:l}=a,m=h-1,n=0===i?1/0:i-1,o="remove"===b&&k?k:j,p=a.parentElement?"string"==typeof a.parentElement?getElement(a.parentElement)||document:a.parentElement:document,q=p.querySelectorAll(c);q.forEach((c,h)=>{h>=m&&h<=n&&0==(h-m)%g&&(c.style.transition=`all ${o} ${l}`,requestAnimationFrame(()=>{"remove"===b?0<f.length?c.classList.remove(...f,...d):c.classList.remove(...e):0<f.length?(()=>{const a=c.getBoundingClientRect(),b=window.innerHeight||document.documentElement.clientHeight;0>a.bottom?(c.classList.add(...f),c.classList.remove(...d)):a.top>b?(c.classList.add(...d),c.classList.remove(...f)):null})():c.classList.add(...d),a.callback&&a.callback(c,b)}))})}_handleClick(a,b,c,d){a.addEventListener("click",()=>{const e=b.classesAdded?"remove":"add";"add"==e?c():d(),b.classesAdded=!b.classesAdded,b.callback&&b.callback(a,e)})}_handleHover(a,b,c,d){b.switchAction?(a.addEventListener("mouseenter",d),a.addEventListener("mouseleave",c)):(a.addEventListener("mouseenter",c),a.addEventListener("mouseleave",d))}_handleScrollInView(a,b,c,d,e){const f=JSON.stringify({threshold:e.sort(),root:null,rootMargin:"0px"});let g=this.scrollObservers.get(f);g||(g=new IntersectionObserver(a=>{a.forEach(a=>{const b=a.target,c=b.__comboClassConfigs||[];c.forEach(c=>{const{switchAction:d,entryThreshold:e,exitThreshold:f,debouncedInit:g,debouncedRemove:h,topAddClasses:i}=c,j=a.intersectionRatio;0<i.length?(()=>{const a=b.getBoundingClientRect(),c=window.innerHeight||document.documentElement.clientHeight;0>a.bottom?g():a.top>c?h():null})():d?(j>=e/100?h():null,null!==f&&j<f/100?g():null):(j>=e/100?g():null,null!==f&&j<f/100?h():null)})})},{threshold:e}),this.scrollObservers.set(f,g)),a.__comboClassConfigs||(a.__comboClassConfigs=[],g.observe(a)),a.__comboClassConfigs.push({...b,debouncedInit:c,debouncedRemove:d}),b.once&&(b.callback=b.callback?(a,c)=>{b.callback(a,c),"remove"===c&&(g.unobserve(a),a.__comboClassConfigs.splice(a.__comboClassConfigs.indexOf(b),1))}:null)}_applyImmediateClasses(a){0<a.topAddClasses.length?(this._initClasses(a,"add"),a.classesAdded=!0):0<a.addClasses.length&&(this._initClasses(a,"add"),a.classesAdded=!0),0<a.removeClasses.length&&(this._initClasses(a,"remove"),a.classesAdded=!1)}}function getElement(a){return a?a.startsWith(".")?document.querySelector(a):document.getElementById(a):null}window.ComboClassConfigurator=ComboClassConfigurator;