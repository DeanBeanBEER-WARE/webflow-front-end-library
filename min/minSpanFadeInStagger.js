class SpanFadeInStagger{constructor(t){this.textIDs=t.textIDs||[],this.easing=t.easing||"ease",this.transition=t.transition||"200ms",this.threshold=t.threshold||.5,this.staggerDelay=t.staggerDelay||100,this.repeat=t.repeat||!1,this.tokenSizeWord=t.tokenSizeWord||!1,this.responsive=t.responsive||!1,this.observers=new Map,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{this.init(),this.responsive&&window.addEventListener("resize",this.debounce(()=>this.init(),300))}):(this.init(),this.responsive&&window.addEventListener("resize",this.debounce(()=>this.init(),300)))}debounce(t,e){let s;return()=>{clearTimeout(s),s=setTimeout(()=>t.apply(this),e)}}init(){this.textIDs.forEach(t=>{const e=document.getElementById(t);if(!e)return void console.error(`Element with ID "${t}" not found.`);if(this.observers.has(t)&&(this.observers.get(t).disconnect(),this.observers.delete(t)),!this.repeat&&"true"===e.getAttribute("data-animated"))return;this.unwrapSpans(e),this.tokenSizeWord?this.wrapWordsInSpans(e):this.wrapLinesInSpans(e),e.style.overflow="hidden";const s=this.tokenSizeWord?Array.from(e.querySelectorAll("span.word-span")):Array.from(e.querySelectorAll("span.line-span"));0===s.length?console.warn(`No ${this.tokenSizeWord?"word":"line"} spans found within element with ID "${t}".`):s.forEach(t=>{t.style.display=this.tokenSizeWord?"inline-block":"block",this.tokenSizeWord&&(t.style.whiteSpace="pre-wrap"),t.style.opacity="0",t.style.transform="translateY(20px)",t.style.transition=`opacity ${this.transition} ${this.easing}, transform ${this.transition} ${this.easing}`,t.style.willChange="opacity, transform"});const n=new IntersectionObserver((t,n)=>{t.forEach(t=>{t.isIntersecting?(this.animateSpans(s),this.repeat||(e.setAttribute("data-animated","true"),n.unobserve(t.target))):this.repeat&&this.resetSpans(s)})},{threshold:this.threshold});n.observe(e),this.observers.set(t,n)})}animateSpans(t){t.forEach((t,e)=>{setTimeout(()=>{t.style.opacity="1",t.style.transform="translateY(0)"},e*this.staggerDelay)})}resetSpans(t){t.forEach(t=>{t.style.opacity="0",t.style.transform="translateY(20px)"})}wrapLinesInSpans(t){const e=document.createRange(),s=this.getTextNodes(t),n=[];s.forEach(e=>{const s=e.textContent.split(/(\s+)/);for(let i=0;i<s.length;i++){const r=s[i];if(""!==r.trim()){const a=document.createElement("span");a.textContent=r+(i+1<s.length&&""===s[i+1].trim()?s[i+1]:""),a.classList.add("word-span"),t.insertBefore(a,e),n.push(a)}}t.removeChild(e)});const i=[];n.forEach(t=>{e.selectNode(t);const s=e.getBoundingClientRect().top;0===i.length||Math.abs(s-i[i.length-1].top)>5?i.push({top:s,spans:[t]}):i[i.length-1].spans.push(t)}),i.forEach(t=>{const e=document.createElement("span");e.classList.add("line-span"),t.spans[0].parentNode.insertBefore(e,t.spans[0]),t.spans.forEach(t=>{e.appendChild(t)})})}wrapWordsInSpans(t){const e=this.getTextNodes(t);e.forEach(e=>{const s=e.textContent.split(/(\s+)/);for(let n=0;n<s.length;n++){const i=s[n];if(""!==i.trim()){const r=document.createElement("span");r.textContent=i+(n+1<s.length&&""===s[n+1].trim()?s[n+1]:""),r.classList.add("word-span"),t.insertBefore(r,e)}}t.removeChild(e)})}getTextNodes(t){let e=[];const s=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1);let n;for(;n=s.nextNode();)""!==n.textContent.trim()&&e.push(n);return e}}window.SpanFadeInStagger=SpanFadeInStagger;
